<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connect 4 vs –ë–æ—Ç</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    text-align: center; 
    background: #003d99; 
    color: white;
    margin: 0; 
    padding: 0;
  }
  h1 { margin-top: 20px; font-size: 28px; }
  #game {
    display: grid; 
    grid-template-columns: repeat(7, 12vw); 
    grid-gap: 2vw; 
    justify-content: center; 
    margin: 5vw auto;
    max-width: 95vw;
  }
  .cell { 
    width: 12vw; 
    height: 12vw; 
    max-width: 60px; 
    max-height: 60px;
    background: #fff; 
    border-radius: 50%; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.3); 
    cursor: pointer; 
    transition: background 0.3s; 
  }
  .red { background: #ff4d4d; }
  .yellow { background: #ffeb3b; }
  #status { margin-top: 20px; font-size: 20px; }
  #restart { 
    margin-top: 20px; 
    padding: 15px 25px; 
    font-size: 18px; 
    border: none; 
    border-radius: 10px; 
    background: #ffffff; 
    color: #003d99; 
    cursor: pointer; 
  }
</style>
</head>
<body>

<h1>üî¥üü° Connect 4 vs –ë–æ—Ç</h1>
<div id="game"></div>
<div id="status">–•–æ–¥: üî¥ (–ò–≥—Ä–æ–∫)</div>
<button id="restart" onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>

<script>
const ROWS = 6;
const COLS = 7;
let board = Array.from({length: ROWS}, () => Array(COLS).fill(null));
let currentPlayer = 'red'; // –ò–≥—Ä–æ–∫ –≤—Å–µ–≥–¥–∞ –∫—Ä–∞—Å–Ω—ã–π
const gameDiv = document.getElementById('game');
const statusDiv = document.getElementById('status');

// ===== –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è =====
function createBoard() {
  gameDiv.innerHTML = '';
  for (let r = 0; r < ROWS; r++) {
    for (let c = 0; c < COLS; c++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.dataset.row = r;
      cell.dataset.col = c;
      cell.addEventListener('click', handleClick);
      gameDiv.appendChild(cell);
    }
  }
}

function restartGame() {
  board = Array.from({length: ROWS}, () => Array(COLS).fill(null));
  currentPlayer = 'red';
  statusDiv.textContent = '–•–æ–¥: üî¥ (–ò–≥—Ä–æ–∫)';
  createBoard();
}

// ===== –•–æ–¥ –∏–≥—Ä–æ–∫–∞ =====
function handleClick(e) {
  if (currentPlayer !== 'red') return; 
  const col = parseInt(e.currentTarget.dataset.col);
  if (makeMove(col)) {
    if (!checkWinLastMove()) {
      currentPlayer = 'yellow';
      statusDiv.textContent = '–•–æ–¥: üü° (–ë–æ—Ç)';
      setTimeout(botMove, 500);
    }
  }
}

// ===== –•–æ–¥ (–∏–≥—Ä–æ–∫ –∏–ª–∏ –±–æ—Ç) =====
function makeMove(col) {
  for (let r = ROWS - 1; r >= 0; r--) {
    if (!board[r][col]) {
      board[r][col] = currentPlayer;
      const cell = document.querySelector(`.cell[data-row='${r}'][data-col='${col}']`);
      cell.classList.add(currentPlayer);
      if (checkWin(r, col)) {
        statusDiv.textContent = `–ü–æ–±–µ–¥–∏–ª: ${currentPlayer === 'red' ? 'üî¥ –ò–≥—Ä–æ–∫' : 'üü° –ë–æ—Ç'}`;
        gameDiv.querySelectorAll('.cell').forEach(c => c.removeEventListener('click', handleClick));
      }
      return true;
    }
  }
  return false;
}

// ===== –£–º–Ω—ã–π –±–æ—Ç =====
function botMove() {
  // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ø—Ä–æ–±—É–µ–º –≤—ã–∏–≥—Ä–∞—Ç—å
  let col = findBestMove('yellow');
  if (col === null) {
    // –ë–ª–æ–∫–∏—Ä—É–µ–º –∏–≥—Ä–æ–∫–∞
    col = findBestMove('red');
  }
  if (col === null) {
    // –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
    let availableCols = [];
    for (let c = 0; c < COLS; c++) if (board[0][c] === null) availableCols.push(c);
    col = availableCols[Math.floor(Math.random() * availableCols.length)];
  }
  currentPlayer = 'yellow';
  makeMove(col);
  if (!checkWinLastMove()) {
    currentPlayer = 'red';
    statusDiv.textContent = '–•–æ–¥: üî¥ (–ò–≥—Ä–æ–∫)';
  }
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –≤—ã–∏–≥—Ä—ã—à–∞
function findBestMove(player) {
  for (let c = 0; c < COLS; c++) {
    for (let r = ROWS - 1; r >= 0; r--) {
      if (!board[r][c]) {
        board[r][c] = player;
        if (checkWin(r, c)) {
          board[r][c] = null;
          return c;
        }
        board[r][c] = null;
        break;
      }
    }
  }
  return null;
}

// ===== –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã =====
function checkWinLastMove() {
  for (let r = 0; r < ROWS; r++) {
    for (let c = 0; c < COLS; c++) {
      if (board[r][c] === currentPlayer && checkWin(r,c)) return true;
    }
  }
  return false;
}

function checkWin(r, c) {
  const directions = [
    [[0,1],[0,-1]],
    [[1,0],[-1,0]],
    [[1,1],[-1,-1]],
    [[1,-1],[-1,1]]
  ];

  for (let dir of directions) {
    let count = 1;
    for (let [dr, dc] of dir) {
      let nr = r + dr, nc = c + dc;
      while (nr >=0 && nr < ROWS && nc >=0 && nc < COLS && board[nr][nc] === currentPlayer) {
        count++;
        nr += dr;
        nc += dc;
      }
    }
    if (count >= 4) return true;
  }
  return false;
}

// ===== –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è =====
createBoard();
</script>

</body>
</html>
